<Window x:Class="neTiPx.ConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="neTiPx - Netwerk Infos - Configuration" Height="580" Width="750" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <!-- Style for dynamically created TabItems to prevent binding errors.
             When TabItems are created programmatically (in CreateIpTab method) before being added to IpTabsControl,
             WPF's default TabItem template tries to bind to TabControl.TabStripPlacement via RelativeSource,
             which fails and generates binding errors. This custom template avoids ancestor bindings. -->
        <Style x:Key="DynamicTabItemStyle" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border Name="Border" 
                                BorderThickness="1,1,1,0" 
                                BorderBrush="#CCCCCC" 
                                Background="White"
                                CornerRadius="4,4,0,0"
                                Padding="12,4,12,4"
                                Margin="0,0,2,0">
                            <ContentPresenter x:Name="ContentSite"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Center"
                                              ContentSource="Header"
                                              Margin="0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#999999"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Gemeinsame Styles für Ping-Header und Zellen -->
        <Style x:Key="PingHeaderText" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="2,0,2,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Foreground" Value="#222"/>
        </Style>
        <Style x:Key="PingCellLabel" TargetType="Label">
            <Setter Property="Padding" Value="4,1,4,1"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#D8D8D8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        <Style x:Key="PingIpTextBox" TargetType="TextBox">
            <Setter Property="Margin" Value="2,0,2,0"/>
            <Setter Property="Padding" Value="4,1,4,1"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="12"/>
            <Style.Triggers>
                <!-- Dezenter Hover-Effekt bei Fehler -->
                <Trigger Property="BorderBrush" Value="IndianRed">
                    <Setter Property="BorderBrush" Value="#FFAA9999"/>
                    <Setter Property="BorderThickness" Value="1.5"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="PingActionButton" TargetType="Button">
            <Setter Property="Margin" Value="2,0,0,0"/>
            <Setter Property="Padding" Value="4,0,4,0"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>
        <!-- Alternierende Zeilen-Hintergründe -->
        <SolidColorBrush x:Key="PingRowEvenBg" Color="#FAFAFA"/>
        <SolidColorBrush x:Key="PingRowOddBg" Color="#F0F0F0"/>
        <Style TargetType="GridSplitter" x:Key="ThinSplitter">
            <Setter Property="Width" Value="2"/>
            <Setter Property="Background" Value="#CCCCCC"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
        </Style>
    </Window.Resources>
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TabControl x:Name="TabControlMain" Grid.Row="0">
            <TabItem Header="Adapter Auswahl">
                <Grid Margin="6">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="Wähle bis zu 2 physische Netzwerkadapter:" FontWeight="Bold" />
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,8,0,8">
                        <StackPanel x:Name="AdaptersPanel" />
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <TabItem Header="IP Settings">
                <Grid Margin="6">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Button x:Name="BtnAddIpTab" Width="100" Margin="2" Click="BtnAddIpTab_Click">Neuer IP-Tab</Button>
                        <Button x:Name="BtnRemoveIpTab" Width="100" Margin="2" Click="BtnRemoveIpTab_Click">Tab löschen</Button>
                        <TextBlock VerticalAlignment="Center" Margin="8,0,0,0" Foreground="Gray">(max. 10)</TextBlock>
                    </StackPanel>

                    <TabControl x:Name="IpTabsControl" Grid.Row="1" />
                </Grid>
            </TabItem>
            <TabItem Header="Tools">
                <Grid Margin="6">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TabControl x:Name="ToolsTabControl" Grid.Row="1">
                        <TabItem Header="Ping">
                            <Grid Margin="6">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
                                    <Button x:Name="BtnAddPingEntry" Width="110" Margin="2" Click="BtnAddPingEntry_Click">Ping hinzufügen</Button>
                                    <Button x:Name="BtnResetAllPingEntries" Width="110" Margin="2" Click="BtnResetAllPingEntries_Click">Reset Alle</Button>
                                    <CheckBox x:Name="ChkPingBackground" Margin="10,2,2,2" VerticalAlignment="Center" Checked="ChkPingBackground_Changed" Unchecked="ChkPingBackground_Changed">
                                        <TextBlock Text="Im Hintergrund weiterlaufen" FontWeight="Normal" />
                                    </CheckBox>
                                    <TextBlock VerticalAlignment="Center" Margin="8,0,0,0" Foreground="Gray">(max. 10 • IP oder Hostname • Spaltenbreite mit Maus anpassen)</TextBlock>
                                </StackPanel>

                                <!-- Resizable column headers -->
                                <Grid Grid.Row="1" Margin="0,0,0,4" x:Name="PingHeaderGrid" Background="#FAFAFA" SnapsToDevicePixels="True">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="58" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="130" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="70" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="110" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="92" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Column="0" Text="Aktiv" Style="{StaticResource PingHeaderText}" />
                                    <GridSplitter Grid.Column="1" Style="{StaticResource ThinSplitter}" />

                                    <TextBlock Grid.Column="2" Text="IP / Hostname" Style="{StaticResource PingHeaderText}" />
                                    <GridSplitter Grid.Column="3" Style="{StaticResource ThinSplitter}" />

                                    <TextBlock Grid.Column="4" Text="Start" Style="{StaticResource PingHeaderText}" />
                                    <GridSplitter Grid.Column="5" Style="{StaticResource ThinSplitter}" />

                                    <TextBlock Grid.Column="6" Text="Fehlend" Style="{StaticResource PingHeaderText}" />
                                    <GridSplitter Grid.Column="7" Style="{StaticResource ThinSplitter}" />

                                    <TextBlock Grid.Column="8" Text="Verlust %" Style="{StaticResource PingHeaderText}" />
                                    <GridSplitter Grid.Column="9" Style="{StaticResource ThinSplitter}" />

                                    <TextBlock Grid.Column="10" Text="Status" Style="{StaticResource PingHeaderText}" />
                                    <GridSplitter Grid.Column="11" Style="{StaticResource ThinSplitter}" />
                                </Grid>

                                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                                    <StackPanel x:Name="PingEntriesPanel" />
                                </ScrollViewer>
                            </Grid>
                        </TabItem>
                        <TabItem Header="WiFi Netzwerke">
                            <Grid Margin="6">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
                                    <Button x:Name="BtnScanWifi" Width="110" Margin="2" Click="BtnScanWifi_Click">Netzwerke scannen</Button>
                                    <TextBlock VerticalAlignment="Center" Margin="8,0,0,0" Foreground="Gray">(Klick auf Spalten zum Sortieren)</TextBlock>
                                </StackPanel>

                                <DataGrid x:Name="WifiDataGrid" Grid.Row="1"
                                          AutoGenerateColumns="False"
                                          IsReadOnly="True"
                                          CanUserAddRows="False"
                                          CanUserDeleteRows="False"
                                          SelectionMode="Single"
                                          AlternatingRowBackground="#F0F0F0"
                                          HeadersVisibility="Column"
                                          GridLinesVisibility="None"
                                          MouseDoubleClick="WifiDataGrid_MouseDoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Signal" Binding="{Binding SignalSymbol}" Width="80" CanUserSort="True" SortMemberPath="SignalStrengthPercent"/>
                                        <DataGridTextColumn Header="SSID" Binding="{Binding SSID}" Width="*" CanUserSort="True"/>
                                        <DataGridTextColumn Header="BSSID" Binding="{Binding BSSID}" Width="150" CanUserSort="True"/>
                                        <DataGridTextColumn Header="dBm" Binding="{Binding SignalStrengthDbm}" Width="80" CanUserSort="True"/>
                                        <DataGridTextColumn Header="Quality %" Binding="{Binding SignalStrengthPercent}" Width="80" CanUserSort="True"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <TabItem Header="Info">
                <ScrollViewer Margin="6" VerticalScrollBarVisibility="Auto">
                    <Grid Margin="6">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Linke Spalte -->
                        <Grid Grid.Column="0" Margin="6">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Oben: Icon und Version -->
                            <StackPanel Grid.Row="0" Orientation="Vertical">
                                <Image x:Name="InfoImage" Width="96" Height="96" Margin="6" Stretch="Uniform" />
                                <TextBlock x:Name="InfoVersionText" Margin="6,0,6,0" FontFamily="Consolas" FontSize="12" Foreground="#444" TextAlignment="Center" HorizontalAlignment="Stretch" FontWeight="Bold" />
                                <Button x:Name="BtnCheckUpdate" Width="140" Margin="6,12,6,6" Click="BtnCheckUpdate_Click" HorizontalAlignment="Center">Nach Updates suchen</Button>
                            </StackPanel>

                            <!-- Unten: Autor, Repository, Support -->
                            <StackPanel x:Name="InfoLeftBottom" Grid.Row="2" Orientation="Vertical" Margin="0,12,0,0">
                            </StackPanel>
                        </Grid>

                        <!-- Rechte Spalte: Beschreibung, Funktionen, etc. -->
                        <StackPanel Grid.Column="1" Orientation="Vertical" Margin="6">
                            <TextBlock x:Name="InfoText" TextWrapping="Wrap" FontFamily="Segoe UI" FontSize="14" Padding="6" LineHeight="18" />
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
            <Button x:Name="BtnApply" Width="80" Margin="4" Click="BtnApply_Click" Visibility="Collapsed">Anwenden</Button>
            <Button x:Name="BtnSave" Width="80" Margin="4" Click="BtnSave_Click">Speichern</Button>
            <Button x:Name="BtnCancel" Width="80" Margin="4" Click="BtnClose_Click">Schliessen</Button>
        </StackPanel>
    </Grid>
</Window>
